# Optimized requirements based on pipreqs analysis
# Only includes packages actually imported in the codebase

# Core web framework
fastapi>=0.104.0
uvicorn
python-multipart  # Required for FastAPI file uploads (UploadFile)
starlette  # Dependency of FastAPI (auto-installed but explicit for clarity)

# Database drivers
asyncpg>=0.28.0
aiosqlite>=0.19.0
psycopg2-binary

# Async file operations
aiofiles>=23.0.0

# Security & authentication
bcrypt
pyotp
itsdangerous
redis[hiredis]>=4.2.0
ldap3
cryptography>=41.0.0  # For ChaCha20-Poly1305 encryption (TLS pipe passwords)
argon2-cffi>=23.1.0   # For Argon2id key derivation (memory-hard, GPU-resistant)

# System utilities
psutil
icmplib

# Configuration parsing
pyyaml>=6.0  # For TLS pipe multi-destination config files

# Archive & compression
py7zr

# HTTP client
requests

# Templates
jinja2

# Structured logging
python-json-logger>=2.0.7

# Testing framework
pytest>=7.4.0
pytest-asyncio>=0.21.0
pytest-cov>=4.1.0
httpx>=0.24.0

# Tor integration
stem

# Packet parsing for CPS pattern extraction
dpkt>=1.9.8

# Local packages
vanguards  # Local package in ./vanguards/

# Build-time only (not included in final binary)
pyinstaller

# Note: Removed unused packages:
# - Flask, flask-cors (migrated to FastAPI)
# - msal (not used)
# - paste (not used)
# - sqlalchemy (not used)
# - configparser (built-in to Python, no need to include)
# - pydantic (auto-installed with fastapi)
# - typing_extensions (auto-installed with fastapi/pydantic)

