# Cloudflare Warp Configuration Example for Wiregate
# Copy relevant sections to your .env file

#############################################
# CLOUDFLARE WARP GLOBAL CONFIGURATION
#############################################

# Enable or disable Cloudflare Warp globally
# Set to "true" to enable, "false" to disable
# Default: false
WGD_WARP_ENABLED=true

# Specify which WireGuard zones should route through Warp
# Comma-separated list of zone names
# Available zones: ADMINS, MEMBERS, GUESTS, LANP2P
# Default: ADMINS,MEMBERS
WGD_WARP_ZONES=ADMINS,MEMBERS

# Cloudflare Warp+ license key (optional)
# Get your key from: https://cloudflarewarp.com/
# Leave empty for free tier
# Default: (empty)
WGD_WARP_LICENSE_KEY=

#############################################
# ADVANCED WARP SETTINGS
#############################################

# Warp endpoint (rarely needs changing)
# Cloudflare automatically routes to nearest edge
# Default: engage.cloudflareclient.com:2408
WGD_WARP_ENDPOINT=engage.cloudflareclient.com:2408

# MTU (Maximum Transmission Unit) for Warp interface
# Lower values are more compatible but slower
# Higher values are faster but may cause issues
# Recommended: 1280-1420
# Default: 1280
WGD_WARP_MTU=1280

#############################################
# USAGE EXAMPLES
#############################################

# Example 1: Basic Setup (Recommended for Most Users)
# Enable Warp for ADMINS and MEMBERS zones with free tier
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS
# WGD_WARP_LICENSE_KEY=
# WGD_WARP_MTU=1280

# Example 2: Warp+ Premium
# Use Warp+ for enhanced performance and priority routing
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS
# WGD_WARP_LICENSE_KEY=XXXXXXXX-XXXXXXXX-XXXXXXXX-XXXXXXXX
# WGD_WARP_MTU=1380

# Example 3: All Zones Through Warp
# Route all WireGuard zones through Cloudflare
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS,GUESTS,LANP2P
# WGD_WARP_LICENSE_KEY=
# WGD_WARP_MTU=1280

# Example 4: Only ADMINS Through Warp
# Selective routing - only administrators use Warp
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS
# WGD_WARP_LICENSE_KEY=
# WGD_WARP_MTU=1280

# Example 5: Only GUESTS Through Warp
# Provide enhanced security for guest users
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=GUESTS
# WGD_WARP_LICENSE_KEY=
# WGD_WARP_MTU=1280

# Example 6: High Performance Setup
# Warp+ with optimized MTU for maximum throughput
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS
# WGD_WARP_LICENSE_KEY=XXXXXXXX-XXXXXXXX-XXXXXXXX-XXXXXXXX
# WGD_WARP_MTU=1420

# Example 7: Maximum Compatibility
# Lower MTU for networks with strict limitations
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS
# WGD_WARP_LICENSE_KEY=
# WGD_WARP_MTU=1280

#############################################
# GETTING STARTED
#############################################

# 1. Set WGD_WARP_ENABLED=true
# 2. Choose which zones to route through Warp (WGD_WARP_ZONES)
# 3. (Optional) Add Warp+ license key for premium features
# 4. Rebuild and restart container:
#    docker-compose down
#    docker-compose up -d --build
# 5. Verify Warp is working:
#    docker logs wiregate | grep WARP
#    docker exec -it wiregate wgcf trace

#############################################
# VERIFICATION & TESTING
#############################################

# Check if Warp is enabled and running:
# docker exec -it wiregate wg show warp

# Test if your traffic is routing through Cloudflare:
# From a VPN client: curl https://api.ipify.org
# Should show a Cloudflare IP, not your server IP

# Check Warp connectivity:
# docker exec -it wiregate wgcf trace
# Should show "warp=on" or "warp=plus"

# View Warp interface statistics:
# docker exec -it wiregate ip -s link show warp

# Check routing rules:
# docker exec -it wiregate ip rule show | grep warp

#############################################
# TROUBLESHOOTING
#############################################

# If Warp doesn't start:
# 1. Check container logs: docker logs wiregate | grep WARP
# 2. Verify wgcf is available: docker exec -it wiregate wgcf --version
# 3. Manually setup: docker exec -it wiregate /opt/wireguarddashboard/src/warp-manager.sh setup

# If no internet when Warp enabled:
# 1. Check Warp status: docker exec -it wiregate wgcf trace
# 2. Verify routing: docker exec -it wiregate ip route show table warp
# 3. Test Warp directly: docker exec -it wiregate ping -I warp 1.1.1.1

# If high latency:
# 1. Try lower MTU: WGD_WARP_MTU=1280
# 2. Check connection to nearest edge: docker exec -it wiregate wgcf trace | grep loc
# 3. Consider Warp+ for priority routing

# If registration fails:
# 1. Check internet: docker exec -it wiregate ping -c 3 1.1.1.1
# 2. Wait 5-10 minutes (rate limiting)
# 3. Manually register: docker exec -it wiregate wgcf register --accept-tos

#############################################
# PERFORMANCE TUNING
#############################################

# For Low Latency:
# - Use Warp+ (WGD_WARP_LICENSE_KEY)
# - Set MTU to 1380-1420
# - Monitor latency: docker exec -it wiregate ping -I warp 1.1.1.1

# For High Throughput:
# - Use Warp+ (WGD_WARP_LICENSE_KEY)
# - Set MTU to 1420 (if network supports)
# - Ensure host has adequate bandwidth

# For Maximum Compatibility:
# - Set MTU to 1280
# - Use free tier initially
# - Test with various destinations

#############################################
# SECURITY CONSIDERATIONS
#############################################

# Privacy Note:
# - Cloudflare can see your destination IPs and metadata
# - They cannot see encrypted content (WireGuard protects this)
# - Your VPN clients' real IPs remain hidden

# Trust Model:
# - Using Warp means trusting Cloudflare with routing
# - Cloudflare is a reputable company with transparent policies
# - Review: https://www.cloudflare.com/privacypolicy/

# Best Practices:
# - Use Warp+ for enhanced features
# - Regularly rotate credentials (re-register)
# - Monitor logs for anomalies
# - Combine with other security measures

#############################################
# COMMON USE CASES & RECOMMENDATIONS
#############################################

# Privacy-Conscious Users:
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS,GUESTS
# WGD_WARP_LICENSE_KEY=XXXXXXXX-XXXXXXXX-XXXXXXXX-XXXXXXXX

# Content Creators (Hide Origin Server):
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS
# WGD_WARP_MTU=1380

# Businesses (Leverage Cloudflare Network):
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS,MEMBERS
# WGD_WARP_LICENSE_KEY=XXXXXXXX-XXXXXXXX-XXXXXXXX-XXXXXXXX
# WGD_WARP_MTU=1420

# Travelers (Consistent Performance):
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=ADMINS
# WGD_WARP_LICENSE_KEY=XXXXXXXX-XXXXXXXX-XXXXXXXX-XXXXXXXX

# Testing/Development:
# WGD_WARP_ENABLED=true
# WGD_WARP_ZONES=GUESTS
# WGD_WARP_MTU=1280

#############################################
# ADDITIONAL RESOURCES
#############################################

# Documentation: ./docs/CLOUDFLARE_WARP_INTEGRATION.md
# wgcf GitHub: https://github.com/ViRb3/wgcf
# Cloudflare Warp: https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/
# Wiregate GitHub: https://github.com/NOXCIS/Wiregate

#############################################
# NOTES
#############################################

# - Warp is OPTIONAL and disabled by default
# - Free tier has no bandwidth limits (subject to fair use)
# - Warp+ costs $4.99/month for premium features
# - Changes require container rebuild: docker-compose up -d --build
# - Credentials persist across restarts in /opt/wireguarddashboard/warp/
# - For persistent storage, mount volume: ./warp-data:/opt/wireguarddashboard/warp
